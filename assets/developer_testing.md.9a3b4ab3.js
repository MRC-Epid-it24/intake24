import{_ as s,c as e,o as t,a}from"./app.526fb1ad.js";const y=JSON.parse('{"title":"Testing","description":"","frontmatter":{},"headers":[{"level":2,"title":"Unit tests","slug":"unit-tests","link":"#unit-tests","children":[]},{"level":2,"title":"Integration tests","slug":"integration-tests","link":"#integration-tests","children":[]},{"level":2,"title":"API Server","slug":"api-server","link":"#api-server","children":[]},{"level":2,"title":"Admin & Survey apps","slug":"admin-survey-apps","link":"#admin-survey-apps","children":[]}],"relativePath":"developer/testing.md"}'),n={name:"developer/testing.md"},o=a(`<h1 id="testing" tabindex="-1">Testing <a class="header-anchor" href="#testing" aria-hidden="true">#</a></h1><p>Tests are set up with <a href="https://jestjs.io" target="_blank" rel="noreferrer">Jest</a> framework.</p><p>All tests can be triggered from top-level repository structure.</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>API Server integration test and some unit tests interacts with database, so be sure to set up empty testing databases and <code>__tests__/.env-test</code> file correctly. See below for more details.</p></div><p>Tests are always located in <code>__tests__</code> folder in each <code>app</code> or <code>package</code> and use following directory structure convention. <code>__tests__</code> folder for <code>apps</code> has <code>unit</code> and <code>integration</code> subfolders as it will most likely have more then unit tests. While unit tests for <code>packages</code> are located directly in <code>__tests__</code>.</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">├─ apps</span></span>
<span class="line"><span style="color:#A6ACCD;">│  └─ {application}</span></span>
<span class="line"><span style="color:#A6ACCD;">│     └─ __tests__</span></span>
<span class="line"><span style="color:#A6ACCD;">│        ├─ unit</span></span>
<span class="line"><span style="color:#A6ACCD;">│           └─ my-function1.spec.ts</span></span>
<span class="line"><span style="color:#A6ACCD;">│        └─ integration</span></span>
<span class="line"><span style="color:#A6ACCD;">│           └─ my-function2.spec.ts</span></span>
<span class="line"><span style="color:#A6ACCD;">├─ packages</span></span>
<span class="line"><span style="color:#A6ACCD;">   └─ {package}</span></span>
<span class="line"><span style="color:#A6ACCD;">      └─ __tests__</span></span>
<span class="line"><span style="color:#A6ACCD;">        └─ my-function3.spec.ts</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><h2 id="unit-tests" tabindex="-1">Unit tests <a class="header-anchor" href="#unit-tests" aria-hidden="true">#</a></h2><p>Use following commands to run unit tests across repository and trigger tests in <code>__tests__</code> folders and <code>__tests__/unit</code> folders for <code>packages</code> and <code>apps</code>, respectively. <code>Jest</code> will search for all files with <code>.spec.ts</code> extension.</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">test:unit</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">test:unit:watch</span></span>
<span class="line"></span></code></pre></div><h2 id="integration-tests" tabindex="-1">Integration tests <a class="header-anchor" href="#integration-tests" aria-hidden="true">#</a></h2><p>Integration tests can be run with following commands. At the moment, there are <code>API Server</code> and <code>Portal</code> integration tests, so it re-triggers the <code>app</code> internal command.</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">test:integration</span></span>
<span class="line"></span></code></pre></div><h2 id="api-server" tabindex="-1">API Server <a class="header-anchor" href="#api-server" aria-hidden="true">#</a></h2><p>To run unit and integration tests on your local machine, start by copying your <code>.env</code> file to <code>__tests__/.env-test</code>.</p><p>Make sure to edit the <code>.env-test</code> file and change the database settings to point to test databases instead of your normal development ones. The foods and system test databases should be empty databases with the necessary extensions (e.g., <code>uuid-ossp</code>) installed.</p><div class="danger custom-block"><p class="custom-block-title">DANGER</p><p><strong>Do not run any tests</strong> unless you&#39;re sure that the database configuration settings in the <code>.env-test</code> file are correct because the test framework setup code will <strong>destroy all data</strong> in those databases!</p></div><p>If using the development VM, simply copy <code>__tests__/.env-test-dev-vm</code> to <code>__tests__/.env-test</code> and you&#39;re good to go.</p><p>Backend testing is set up for <code>unit</code> and <code>integration</code> tests. You can run tests with following commands.</p><p>Unit tests</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">test:unit</span></span>
<span class="line"></span></code></pre></div><p>Unit tests watch for development</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">test:unit:watch</span></span>
<span class="line"></span></code></pre></div><p>Integration tests</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">test:integration</span></span>
<span class="line"></span></code></pre></div><p>Integration tests watch for development</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">test:integration:watch</span></span>
<span class="line"></span></code></pre></div><h2 id="admin-survey-apps" tabindex="-1">Admin &amp; Survey apps <a class="header-anchor" href="#admin-survey-apps" aria-hidden="true">#</a></h2><p>Front-ends use Vue.js Jest implementation, so you can run tests with:</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">test</span></span>
<span class="line"></span></code></pre></div>`,29),l=[o];function p(c,i,r,d,h,u){return t(),e("div",null,l)}const m=s(n,[["render",p]]);export{y as __pageData,m as default};

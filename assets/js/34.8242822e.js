(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{416:function(t,s,e){"use strict";e.r(s);var a=e(26),r=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"surveys-public"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#surveys-public"}},[t._v("#")]),t._v(" Surveys - public")]),t._v(" "),e("p",[t._v("Survey-specific public API endpoints.")]),t._v(" "),e("h2",{attrs:{id:"public-survey-list"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#public-survey-list"}},[t._v("#")]),t._v(" Public survey list")]),t._v(" "),e("p",[t._v("Publicly accessible survey list. Returns list of public surveys.")]),t._v(" "),e("h3",{attrs:{id:"request"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#request"}},[t._v("#")]),t._v(" Request")]),t._v(" "),e("div",{staticClass:"language-http extra-class"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[t._v("GET /api/surveys\n\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Content-Type:")]),t._v(" application/json\n")])])]),e("h3",{attrs:{id:"response"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#response"}},[t._v("#")]),t._v(" Response")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" OK\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"localeId"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),e("h2",{attrs:{id:"public-survey-parameters"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#public-survey-parameters"}},[t._v("#")]),t._v(" Public survey parameters")]),t._v(" "),e("p",[t._v("Publicly accessible API end-point.")]),t._v(" "),e("p",[t._v("Returns survey parameters necessary to render the survey login page such as the language settings and the support e-mail.")]),t._v(" "),e("h3",{attrs:{id:"request-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#request-2"}},[t._v("#")]),t._v(" Request")]),t._v(" "),e("div",{staticClass:"language-http extra-class"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[t._v("GET /api/surveys/{surveyId}\n\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Content-Type:")]),t._v(" application/json\n")])])]),e("h3",{attrs:{id:"response-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#response-2"}},[t._v("#")]),t._v(" Response")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" OK\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"localeId"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"respondentLanguageId"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"supportEmail"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"originatingURL"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string?\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("where:")]),t._v(" "),e("p",[e("strong",[t._v("originatingURL")]),t._v(" is a feature for integrating with external systems. In v3 respondents are redirected to this URL\nin case of authentication failure so the external system can perform the authentication for them. A better solution\nshould be used for v4.")]),t._v(" "),e("h2",{attrs:{id:"generate-user"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#generate-user"}},[t._v("#")]),t._v(" Generate user")]),t._v(" "),e("p",[t._v("Publicly accessible API end-point.")]),t._v(" "),e("p",[t._v("Automatically create a new user account with a respondent role and random credentials if allowed by the survey settings.")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("This functionality has to be allowed in survey settings. It is using reCaptcha challenge and is rate-limited.")])]),t._v(" "),e("h3",{attrs:{id:"request-3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#request-3"}},[t._v("#")]),t._v(" Request")]),t._v(" "),e("div",{staticClass:"language-http extra-class"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[t._v("POST /api/surveys/{surveyId}/generate-user\n\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Content-Type:")]),t._v(" application/json"),e("span",{pre:!0,attrs:{class:"token application-json"}},[t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"reCaptchaToken"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),e("h3",{attrs:{id:"response-3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#response-3"}},[t._v("#")]),t._v(" Response")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" OK\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"userName"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"password"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h2",{attrs:{id:"create-user"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#create-user"}},[t._v("#")]),t._v(" Create user")]),t._v(" "),e("p",[t._v("Publicly accessible API end-point.")]),t._v(" "),e("p",[t._v("Create a new user account with a specific user name and a unique redirect URL if allowed by the survey settings.\nCurrently used for integration with external survey systems.")]),t._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),e("p",[t._v("This function presents a vulnerability similar to the generate user function. The JWT signing is done on the\nclient side by the current users of this function and can therefore be easily extracted.")])]),t._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/MRC-Epid-it24/api-server/blob/master/ApiPlayServer/app/controllers/system/user/GeneratedUsersController.scala#L126-L153",target:"_blank",rel:"noopener noreferrer"}},[t._v("v3 implementation"),e("OutboundLink")],1)]),t._v(" "),e("h3",{attrs:{id:"request-4"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#request-4"}},[t._v("#")]),t._v(" Request")]),t._v(" "),e("div",{staticClass:"language-http extra-class"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[t._v("POST /api/surveys/{surveyId}/create-user?params={token}\n\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Content-Type:")]),t._v(" application/json\n")])])]),e("p",[t._v("where:")]),t._v(" "),e("p",[e("strong",[t._v("surveyId")]),t._v(" is the survey ID,")]),t._v(" "),e("p",[e("strong",[t._v("token")]),t._v(" is the request parameters encoded as a signed JWT token. The signing key is set up in the survey parameters.")]),t._v(" "),e("h3",{attrs:{id:"response-4"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#response-4"}},[t._v("#")]),t._v(" Response")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" OK\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"userId"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"redirect"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"authToken"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("where:")]),t._v(" "),e("p",[e("strong",[t._v("userId")]),t._v(" is the internal Intake24 user ID,")]),t._v(" "),e("p",[e("strong",[t._v("redirect")]),t._v(" is the redirect URL decoded from the input token,")]),t._v(" "),e("p",[e("strong",[t._v("authToken")]),t._v(" is the authentication token for the new user.")])])}),[],!1,null,null,null);s.default=r.exports}}]);
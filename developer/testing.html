<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Testing | Intake24</title>
    <meta name="description" content="Intake24 dietary recall system">
    <link rel="stylesheet" href="/assets/style.5085eda4.css">
    <link rel="modulepreload" href="/assets/app.5684b170.js">
    <link rel="modulepreload" href="/assets/developer_testing.md.50d9979f.lean.js">
    
    <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="twitter:title" content="Testing | Intake24">
  <meta property="og:title" content="Testing | Intake24">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-4c49e554><div class="sidebar-button" data-v-4c49e554><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/" aria-label="Intake24, back to home" data-v-4c49e554 data-v-c186fd98><!----> Intake24</a><div class="flex-grow" data-v-4c49e554></div><div class="nav" data-v-4c49e554><nav class="nav-links" data-v-4c49e554 data-v-0c98bea2><!--[--><div class="item" data-v-0c98bea2><div class="nav-link" data-v-0c98bea2 data-v-95c4d90e><a class="item" href="/overview/" data-v-95c4d90e>Overview <!----></a></div></div><div class="item" data-v-0c98bea2><div class="nav-link" data-v-0c98bea2 data-v-95c4d90e><a class="item" href="/config/" data-v-95c4d90e>Configuration <!----></a></div></div><div class="item" data-v-0c98bea2><div class="nav-link" data-v-0c98bea2 data-v-95c4d90e><a class="item" href="/api/" data-v-95c4d90e>API <!----></a></div></div><div class="item" data-v-0c98bea2><div class="nav-link" data-v-0c98bea2 data-v-95c4d90e><a class="item" href="/admin/" data-v-95c4d90e>Admin <!----></a></div></div><div class="item" data-v-0c98bea2><div class="nav-link" data-v-0c98bea2 data-v-95c4d90e><a class="item" href="/survey/" data-v-95c4d90e>Survey <!----></a></div></div><div class="item" data-v-0c98bea2><div class="nav-link" data-v-0c98bea2 data-v-95c4d90e><a class="item" href="/data-dictionary/" data-v-95c4d90e>Data Dictionary <!----></a></div></div><div class="item" data-v-0c98bea2><div class="nav-link" data-v-0c98bea2 data-v-95c4d90e><a class="item active" href="/developer/" data-v-95c4d90e>Developer resources <!----></a></div></div><!--]--><!----><div class="item" data-v-0c98bea2><div class="nav-link" data-v-0c98bea2 data-v-95c4d90e><a class="item isExternal" href="https://github.com/MRC-Epid-it24/intake24" target="_blank" rel="noopener noreferrer" data-v-95c4d90e>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-95c4d90e><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-cb99f8ea><nav class="nav-links nav" data-v-cb99f8ea data-v-0c98bea2><!--[--><div class="item" data-v-0c98bea2><div class="nav-link" data-v-0c98bea2 data-v-95c4d90e><a class="item" href="/overview/" data-v-95c4d90e>Overview <!----></a></div></div><div class="item" data-v-0c98bea2><div class="nav-link" data-v-0c98bea2 data-v-95c4d90e><a class="item" href="/config/" data-v-95c4d90e>Configuration <!----></a></div></div><div class="item" data-v-0c98bea2><div class="nav-link" data-v-0c98bea2 data-v-95c4d90e><a class="item" href="/api/" data-v-95c4d90e>API <!----></a></div></div><div class="item" data-v-0c98bea2><div class="nav-link" data-v-0c98bea2 data-v-95c4d90e><a class="item" href="/admin/" data-v-95c4d90e>Admin <!----></a></div></div><div class="item" data-v-0c98bea2><div class="nav-link" data-v-0c98bea2 data-v-95c4d90e><a class="item" href="/survey/" data-v-95c4d90e>Survey <!----></a></div></div><div class="item" data-v-0c98bea2><div class="nav-link" data-v-0c98bea2 data-v-95c4d90e><a class="item" href="/data-dictionary/" data-v-95c4d90e>Data Dictionary <!----></a></div></div><div class="item" data-v-0c98bea2><div class="nav-link" data-v-0c98bea2 data-v-95c4d90e><a class="item active" href="/developer/" data-v-95c4d90e>Developer resources <!----></a></div></div><!--]--><!----><div class="item" data-v-0c98bea2><div class="nav-link" data-v-0c98bea2 data-v-95c4d90e><a class="item isExternal" href="https://github.com/MRC-Epid-it24/intake24" target="_blank" rel="noopener noreferrer" data-v-95c4d90e>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-95c4d90e><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav><!--[--><!--]--><ul class="sidebar-links" data-v-cb99f8ea><!--[--><li class="sidebar-link"><p class="sidebar-link-item">Developer resources</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/developer/">Introduction</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/developer/source-code">Source code</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/developer/getting-started">Getting started</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/developer/technology-stack">Technology Stack</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item active" href="/developer/testing">Testing</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#api-server">API Server</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#admin-survey-apps">Admin &amp; Survey apps</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/developer/vm">Development virtual machine</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/developer/v3-survey">Version 3 recall model</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/developer/portion-size">Portion size methods</a><!----></li></ul></li><!--]--></ul><!--[--><!--]--></aside><div class="sidebar-mask"></div><main class="page" data-v-b191eb7a><div class="container" data-v-b191eb7a><!--[--><!--]--><div style="position:relative;" class="content" data-v-b191eb7a><div><h1 id="testing" tabindex="-1">Testing <a class="header-anchor" href="#testing" aria-hidden="true">#</a></h1><p>Tests are set up with <a href="https://jestjs.io" target="_blank" rel="noopener noreferrer">Jest</a> framework.</p><p>All tests can be triggered from top-level repository structure.</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>API Server integration test and some unit tests interacts with database, so be sure to set up empty testing databases and <code>__tests__/.env-test</code> file correctly. See below for more details.</p></div><p>Tests are always located in <code>__tests__</code> folder in each <code>app</code> or <code>package</code> and use following directory structure convention. <code>__tests__</code> folder for <code>apps</code> has <code>unit</code> and <code>integration</code> subfolders as it will most likely have more then unit tests. While unit tests for <code>packages</code> are located directly in <code>__tests__</code>.</p><div class="language-"><pre><code>├─ apps
│  └─ {application}
│     └─ __tests__
│        ├─ unit
│           └─ my-function1.spec.ts
│        └─ integration
│           └─ my-function2.spec.ts
├─ packages
   └─ {package}
      └─ __tests__
        └─ my-function3.spec.ts
</code></pre></div><p>Unit tests in <code>apps</code> folders</p><p>Use following commands to run unit tests across repository and trigger tests in <code>__tests__</code> folders and <code>__tests__/unit</code> folders for package and apps, respectively. <code>Jest</code> will search for all files with <code>.spec.ts</code> extension.</p><div class="language-sh"><pre><code>pnpm test:unit

pnpm test:unit:watch
</code></pre></div><p>Integration tests can be run with following commands. At the moment, there are only API Server integration tests, so it re-triggers the api internal npm command.</p><div class="language-sh"><pre><code>pnpm test:integration

pnpm test:integration:watch
</code></pre></div><h2 id="api-server" tabindex="-1">API Server <a class="header-anchor" href="#api-server" aria-hidden="true">#</a></h2><p>To run unit and integration tests on your local machine, start by copying your <code>.env</code> file to <code>__tests__/.env-test</code>.</p><p>Make sure to edit the <code>.env-test</code> file and change the database settings to point to test databases instead of your normal development ones. The foods and system test databases should be empty databases with the necessary extensions (e.g., <code>uuid-ossp</code>) installed.</p><div class="danger custom-block"><p class="custom-block-title">WARNING</p><p><strong>Do not run any tests</strong> unless you&#39;re sure that the database configuration settings in the <code>.env-test</code> file are correct because the test framework setup code will <strong>destroy all data</strong> in those databases!</p></div><p>If using the development VM, simply copy <code>__tests__/.env-test-dev-vm</code> to <code>__tests__/.env-test</code> and you&#39;re good to go.</p><p>Backend testing is set up for <code>unit</code> and <code>integration</code> tests. You can run tests with following commands.</p><p>Unit tests</p><div class="language-sh"><pre><code>pnpm test:unit
</code></pre></div><p>Unit tests watch for development</p><div class="language-sh"><pre><code>pnpm test:unit:watch
</code></pre></div><p>Integration tests</p><div class="language-sh"><pre><code>pnpm test:integration
</code></pre></div><p>Integration tests watch for development</p><div class="language-sh"><pre><code>pnpm test:integration:watch
</code></pre></div><h2 id="admin-survey-apps" tabindex="-1">Admin &amp; Survey apps <a class="header-anchor" href="#admin-survey-apps" aria-hidden="true">#</a></h2><p>Frontends use Vue.js Jest implementation, so you can run tests with:</p><div class="language-sh"><pre><code>pnpm test
</code></pre></div></div></div><footer class="page-footer" data-v-b191eb7a data-v-1a1009c1><div class="edit" data-v-1a1009c1><div class="edit-link" data-v-1a1009c1 data-v-f913b3d8><!----></div></div><div class="updated" data-v-1a1009c1><!----></div></footer><div class="next-and-prev-link" data-v-b191eb7a data-v-2fd08a80><div class="container" data-v-2fd08a80><div class="prev" data-v-2fd08a80><a class="link" href="/developer/technology-stack" data-v-2fd08a80><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-prev" data-v-2fd08a80><path d="M19,11H7.4l5.3-5.3c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-7,7c-0.1,0.1-0.2,0.2-0.2,0.3c-0.1,0.2-0.1,0.5,0,0.8c0.1,0.1,0.1,0.2,0.2,0.3l7,7c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L7.4,13H19c0.6,0,1-0.4,1-1S19.6,11,19,11z"></path></svg><span class="text" data-v-2fd08a80>Technology Stack</span></a></div><div class="next" data-v-2fd08a80><a class="link" href="/developer/vm" data-v-2fd08a80><span class="text" data-v-2fd08a80>Development virtual machine</span><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-next" data-v-2fd08a80><path d="M19.9,12.4c0.1-0.2,0.1-0.5,0-0.8c-0.1-0.1-0.1-0.2-0.2-0.3l-7-7c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l5.3,5.3H5c-0.6,0-1,0.4-1,1s0.4,1,1,1h11.6l-5.3,5.3c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3l7-7C19.8,12.6,19.9,12.5,19.9,12.4z"></path></svg></a></div></div></div><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"admin_acl_index.md\":\"8796a5ba\",\"admin_acl_permissions.md\":\"b0ea37e6\",\"admin_acl_roles.md\":\"62b6ab74\",\"admin_acl_users.md\":\"c19c621f\",\"admin_images_as-served-sets.md\":\"ae1847f8\",\"admin_images_guide-images.md\":\"2b51551e\",\"admin_images_image-maps.md\":\"55e3eb93\",\"admin_images_index.md\":\"d93fa6df\",\"admin_index.md\":\"7a366a36\",\"admin_localization_languages.md\":\"867feccd\",\"admin_localization_locales.md\":\"3fd273ea\",\"admin_nutritionist-dictionary.md\":\"df177a32\",\"admin_surveys_feedback-schemes.md\":\"596c05eb\",\"admin_surveys_index.md\":\"f73d21df\",\"admin_surveys_survey-scheme-questions.md\":\"753df69c\",\"admin_surveys_survey-schemes.md\":\"15f244d7\",\"admin_system_job-types.md\":\"e35cf150\",\"admin_system_jobs.md\":\"80260224\",\"admin_system_sign-in-logs.md\":\"0d14bda4\",\"admin_system_tasks.md\":\"f95416ab\",\"api_admin_feedback-schemes.md\":\"25047604\",\"api_admin_food-groups.md\":\"7d956a60\",\"api_admin_images_as-served-images.md\":\"2d274d14\",\"api_admin_images_as-served-sets.md\":\"6c9b0fb2\",\"api_admin_images_guides.md\":\"d7e16758\",\"api_admin_images_maps.md\":\"e9fad1a0\",\"api_admin_jobs.md\":\"05f7caec\",\"api_admin_languages.md\":\"dc5418c5\",\"api_admin_locales.md\":\"01b44be0\",\"api_admin_nutrient-tables.md\":\"68b65da7\",\"api_admin_permissions.md\":\"5a5c0165\",\"api_admin_roles.md\":\"944bbe6b\",\"api_admin_sign-in-logs.md\":\"2aa29105\",\"api_admin_survey-scheme-questions.md\":\"80f20e0e\",\"api_admin_survey-schemes.md\":\"66360f5c\",\"api_admin_surveys_data-export.md\":\"80a07d7e\",\"api_admin_surveys_mgmt.md\":\"28ff5237\",\"api_admin_surveys_respondents.md\":\"48beac4e\",\"api_admin_surveys_submissions.md\":\"8d4b6740\",\"api_admin_surveys_surveys.md\":\"8bddd9ba\",\"api_admin_tasks.md\":\"220e7957\",\"api_admin_user_jobs.md\":\"c2403030\",\"api_admin_user_profile.md\":\"a7b72816\",\"api_admin_users.md\":\"edd53bba\",\"api_authentication.md\":\"ef6c25cb\",\"api_index.md\":\"e2032ce7\",\"api_respondent_feedback.md\":\"88da0310\",\"api_respondent_food-data.md\":\"a81efdde\",\"api_respondent_food-lookup.md\":\"c44b8d42\",\"api_respondent_surveys-public.md\":\"95b583e1\",\"api_respondent_surveys-respondent.md\":\"2171749e\",\"api_respondent_user.md\":\"76cac633\",\"api_subscriptions.md\":\"517f44ab\",\"config_admin_index.md\":\"caad9747\",\"config_api_acl.md\":\"feda51e8\",\"config_api_application.md\":\"b4d410a0\",\"config_api_cache.md\":\"5b71a2aa\",\"config_api_database.md\":\"9949b86c\",\"config_api_filesystem.md\":\"cf3517b8\",\"config_api_log.md\":\"61297273\",\"config_api_mail.md\":\"99f78c0a\",\"config_api_queue.md\":\"3326aa77\",\"config_api_security.md\":\"ae8908ad\",\"config_api_services.md\":\"5ffdceba\",\"config_api_session.md\":\"452a83c5\",\"config_index.md\":\"76484119\",\"config_survey_index.md\":\"ad3b6c27\",\"data-dictionary_admin.md\":\"741e4d60\",\"data-dictionary_index.md\":\"4c489fea\",\"data-dictionary_survey.md\":\"9f2c590c\",\"deployment_index.md\":\"a938f9a3\",\"developer_getting-started.md\":\"17324be8\",\"developer_index.md\":\"88ab23ef\",\"developer_portion-size.md\":\"41e1515a\",\"developer_source-code.md\":\"88809e96\",\"developer_technology-stack.md\":\"1738f94f\",\"developer_testing.md\":\"50d9979f\",\"developer_v3-survey.md\":\"cadcfa68\",\"developer_vm.md\":\"b3a23d35\",\"index.md\":\"ebf3b191\",\"overview_cli_generate-env.md\":\"d8fd32e3\",\"overview_cli_index.md\":\"c82d83de\",\"overview_get-started.md\":\"b6079c8f\",\"overview_index.md\":\"0691c96c\",\"overview_requirements.md\":\"2ffa2de4\",\"survey_index.md\":\"6321f047\"}")</script>
    <script type="module" async src="/assets/app.5684b170.js"></script>
    
  </body>
</html>
<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>API Server | Intake24 NG Documentation</title>
    <meta name="generator" content="VuePress 1.5.4">
    
    <meta name="description" content="Intake24 dietary recall system">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="preload" href="/assets/css/0.styles.c95a076b.css" as="style"><link rel="preload" href="/assets/js/app.f0ab9d08.js" as="script"><link rel="preload" href="/assets/js/2.23416343.js" as="script"><link rel="preload" href="/assets/js/25.70f658ff.js" as="script"><link rel="prefetch" href="/assets/js/10.2eef3298.js"><link rel="prefetch" href="/assets/js/11.892ce902.js"><link rel="prefetch" href="/assets/js/12.c0dbf481.js"><link rel="prefetch" href="/assets/js/13.8fd8b379.js"><link rel="prefetch" href="/assets/js/14.f2a4541f.js"><link rel="prefetch" href="/assets/js/15.7389626c.js"><link rel="prefetch" href="/assets/js/16.ac22af4d.js"><link rel="prefetch" href="/assets/js/17.0ef9d251.js"><link rel="prefetch" href="/assets/js/18.eb4f314a.js"><link rel="prefetch" href="/assets/js/19.32a863fe.js"><link rel="prefetch" href="/assets/js/20.1134d90b.js"><link rel="prefetch" href="/assets/js/21.6a78fcd5.js"><link rel="prefetch" href="/assets/js/22.9e9de4d9.js"><link rel="prefetch" href="/assets/js/23.42654953.js"><link rel="prefetch" href="/assets/js/24.1a5a6558.js"><link rel="prefetch" href="/assets/js/26.01ff65ca.js"><link rel="prefetch" href="/assets/js/27.f6054a4b.js"><link rel="prefetch" href="/assets/js/28.6a224341.js"><link rel="prefetch" href="/assets/js/29.f9d00cc5.js"><link rel="prefetch" href="/assets/js/3.cc6d67af.js"><link rel="prefetch" href="/assets/js/30.8f4ddde3.js"><link rel="prefetch" href="/assets/js/31.fc9977ba.js"><link rel="prefetch" href="/assets/js/32.56424b95.js"><link rel="prefetch" href="/assets/js/33.d43e177c.js"><link rel="prefetch" href="/assets/js/4.b393f243.js"><link rel="prefetch" href="/assets/js/5.08ecba02.js"><link rel="prefetch" href="/assets/js/6.623fb51b.js"><link rel="prefetch" href="/assets/js/7.04c76828.js"><link rel="prefetch" href="/assets/js/8.e8d67fbf.js"><link rel="prefetch" href="/assets/js/9.2a24c86d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c95a076b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Intake24 NG Documentation</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/config/" class="nav-link router-link-active">
  Configuration
</a></div><div class="nav-item"><a href="/survey/" class="nav-link">
  Survey
</a></div><div class="nav-item"><a href="/admin/" class="nav-link">
  Admin
</a></div><div class="nav-item"><a href="/api/" class="nav-link">
  API
</a></div><div class="nav-item"><a href="/data-dictionary/" class="nav-link">
  Data Dictionary
</a></div><div class="nav-item"><a href="/developer/" class="nav-link">
  Developer resources
</a></div><div class="nav-item"><a href="https://github.com/MRC-Epid-it24/intake24" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/config/" class="nav-link router-link-active">
  Configuration
</a></div><div class="nav-item"><a href="/survey/" class="nav-link">
  Survey
</a></div><div class="nav-item"><a href="/admin/" class="nav-link">
  Admin
</a></div><div class="nav-item"><a href="/api/" class="nav-link">
  API
</a></div><div class="nav-item"><a href="/data-dictionary/" class="nav-link">
  Data Dictionary
</a></div><div class="nav-item"><a href="/developer/" class="nav-link">
  Developer resources
</a></div><div class="nav-item"><a href="https://github.com/MRC-Epid-it24/intake24" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Configuration</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/config/" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="/config/api-server.html" aria-current="page" class="active sidebar-link">API Server</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/config/api-server.html#application" class="sidebar-link">Application</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/config/api-server.html#node-environment" class="sidebar-link">Node environment</a></li><li class="sidebar-sub-header"><a href="/config/api-server.html#name" class="sidebar-link">Name</a></li><li class="sidebar-sub-header"><a href="/config/api-server.html#host" class="sidebar-link">Host</a></li><li class="sidebar-sub-header"><a href="/config/api-server.html#port" class="sidebar-link">Port</a></li><li class="sidebar-sub-header"><a href="/config/api-server.html#sites-urls" class="sidebar-link">Sites URLs</a></li></ul></li><li class="sidebar-sub-header"><a href="/config/api-server.html#access-control-list-acl" class="sidebar-link">Access control list (ACL)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/config/api-server.html#roles" class="sidebar-link">Roles</a></li><li class="sidebar-sub-header"><a href="/config/api-server.html#permissions" class="sidebar-link">Permissions</a></li></ul></li><li class="sidebar-sub-header"><a href="/config/api-server.html#database" class="sidebar-link">Database</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/config/api-server.html#host-2" class="sidebar-link">Host</a></li><li class="sidebar-sub-header"><a href="/config/api-server.html#port-2" class="sidebar-link">Port</a></li><li class="sidebar-sub-header"><a href="/config/api-server.html#database-2" class="sidebar-link">Database</a></li><li class="sidebar-sub-header"><a href="/config/api-server.html#username" class="sidebar-link">Username</a></li><li class="sidebar-sub-header"><a href="/config/api-server.html#password" class="sidebar-link">Password</a></li><li class="sidebar-sub-header"><a href="/config/api-server.html#dialect" class="sidebar-link">Dialect</a></li></ul></li><li class="sidebar-sub-header"><a href="/config/api-server.html#filesystem" class="sidebar-link">Filesystem</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/config/api-server.html#logs-dir" class="sidebar-link">Logs dir</a></li><li class="sidebar-sub-header"><a href="/config/api-server.html#public-dir" class="sidebar-link">Public dir</a></li></ul></li><li class="sidebar-sub-header"><a href="/config/api-server.html#mail" class="sidebar-link">Mail</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/config/api-server.html#mailer" class="sidebar-link">Mailer</a></li><li class="sidebar-sub-header"><a href="/config/api-server.html#smtp-transport" class="sidebar-link">SMTP transport</a></li><li class="sidebar-sub-header"><a href="/config/api-server.html#from" class="sidebar-link">From</a></li></ul></li><li class="sidebar-sub-header"><a href="/config/api-server.html#queue" class="sidebar-link">Queue</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/config/api-server.html#redis-instance-connection" class="sidebar-link">Redis instance connection</a></li></ul></li><li class="sidebar-sub-header"><a href="/config/api-server.html#security" class="sidebar-link">Security</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/config/api-server.html#cross-origin-resource-sharing-cors" class="sidebar-link">Cross-origin resource sharing (CORS)</a></li><li class="sidebar-sub-header"><a href="/config/api-server.html#json-web-tokens" class="sidebar-link">JSON web tokens</a></li><li class="sidebar-sub-header"><a href="/config/api-server.html#jwt-refresh-token-cookie" class="sidebar-link">JWT Refresh token cookie</a></li></ul></li><li class="sidebar-sub-header"><a href="/config/api-server.html#multi-factor-authentication-mfa" class="sidebar-link">Multi-factor authentication (MFA)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/config/api-server.html#enabled" class="sidebar-link">Enabled</a></li><li class="sidebar-sub-header"><a href="/config/api-server.html#provider" class="sidebar-link">Provider</a></li><li class="sidebar-sub-header"><a href="/config/api-server.html#duo-provider-settings" class="sidebar-link">Duo provider settings</a></li></ul></li><li class="sidebar-sub-header"><a href="/config/api-server.html#google-recaptcha" class="sidebar-link">Google reCAPTCHA</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/config/api-server.html#enabled-2" class="sidebar-link">Enabled</a></li><li class="sidebar-sub-header"><a href="/config/api-server.html#secret-key-2" class="sidebar-link">Secret key</a></li></ul></li><li class="sidebar-sub-header"><a href="/config/api-server.html#passwords" class="sidebar-link">Passwords</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/config/api-server.html#expire" class="sidebar-link">Expire</a></li><li class="sidebar-sub-header"><a href="/config/api-server.html#throttle" class="sidebar-link">Throttle</a></li></ul></li></ul></li><li><a href="/config/admin.html" class="sidebar-link">Admin site</a></li><li><a href="/config/survey.html" class="sidebar-link">Survey site</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="api-server"><a href="#api-server" class="header-anchor">#</a> API Server</h1> <p>Configuration is structured to following sections:</p> <ul><li><a href="#application">Application</a></li> <li><a href="#access-control-list-acl">Access Control List (ACL)</a></li> <li><a href="#database">Database</a></li> <li><a href="#filesystem">Filesystem</a></li> <li><a href="#mail">Mail</a></li> <li><a href="#queue">Queue</a></li> <li><a href="#security">Security</a></li></ul> <h2 id="application"><a href="#application" class="header-anchor">#</a> Application</h2> <p>Path: <code>src/config/app.ts</code></p> <h3 id="node-environment"><a href="#node-environment" class="header-anchor">#</a> Node environment</h3> <p>Node environment to start the application in.</p> <ul><li>object-path: <code>env</code></li> <li>dotenv var: <code>NODE_ENV</code></li> <li>type: <code>'development' | 'test' | 'production'</code></li> <li>default: <code>'development'</code></li></ul> <h3 id="name"><a href="#name" class="header-anchor">#</a> Name</h3> <p>Application name.</p> <ul><li>object-path: <code>env</code></li> <li>dotenv var: <code>APP_NAME</code></li> <li>type: <code>string</code></li> <li>default: <code>'Intake24'</code></li></ul> <h3 id="host"><a href="#host" class="header-anchor">#</a> Host</h3> <p>Internal hostname application listens on.</p> <ul><li>object-path: <code>host</code></li> <li>dotenv var: <code>APP_HOST</code></li> <li>type: <code>string</code></li> <li>default: <code>'localhost'</code></li></ul> <h3 id="port"><a href="#port" class="header-anchor">#</a> Port</h3> <p>Internal port application listens on.</p> <ul><li>object-path: <code>port</code></li> <li>dotenv var: <code>APP_PORT</code></li> <li>type: <code>number</code></li> <li>default: <code>3100</code></li></ul> <h3 id="sites-urls"><a href="#sites-urls" class="header-anchor">#</a> Sites URLs</h3> <p>List of sites URLs. These can either be relative or absolute URLs.</p> <ul><li>absolute URL -&gt; site is hosted on different domain</li> <li>relative URL -&gt; site is hosted on same domain. URL gets registered as route.</li></ul> <h4 id="admin-url"><a href="#admin-url" class="header-anchor">#</a> Admin URL</h4> <p>URL of admin site.</p> <ul><li>object-path: <code>url.admin</code></li> <li>dotenv var: <code>APP_URL_ADMIN</code></li> <li>type: <code>string</code></li> <li>default: <code>'/admin'</code></li></ul> <h4 id="documentation-url"><a href="#documentation-url" class="header-anchor">#</a> Documentation URL</h4> <p>URL of documentation site.</p> <ul><li>object-path: <code>url.docs</code></li> <li>dotenv var: <code>APP_URL_DOCS</code></li> <li>type: <code>string</code></li> <li>default: <code>'/docs'</code></li></ul> <h4 id="survey-url"><a href="#survey-url" class="header-anchor">#</a> Survey URL</h4> <p>URL of survey site.</p> <ul><li>object-path: <code>url.survey</code></li> <li>dotenv var: <code>APP_URL_SURVEY</code></li> <li>type: <code>string</code></li> <li>default: <code>'/survey'</code></li></ul> <h2 id="access-control-list-acl"><a href="#access-control-list-acl" class="header-anchor">#</a> Access control list (ACL)</h2> <p>Access control list (<code>ACL</code>) implementation is based on three models:</p> <ul><li><code>user</code></li> <li><code>role</code></li> <li><code>permission</code></li></ul> <p>Relations between the models are defined as follows:</p> <ul><li><code>many-to-many</code> between <code>user</code> and <code>role</code></li> <li><code>many-to-many</code> between <code>user</code> and <code>permission</code></li> <li><code>many-to-many</code> between <code>role</code> and <code>permission</code></li></ul> <p>This allows to grant permissions to users in two ways:</p> <ul><li>directly associate <code>permission</code> with <code>user</code></li> <li>associate <code>permission</code> with <code>user</code> through <code>role</code> (acting as grouping record for a set of permissions)</li></ul> <p>Path: <code>src/config/acl.ts</code></p> <h3 id="roles"><a href="#roles" class="header-anchor">#</a> Roles</h3> <p>List of special-purpose roles.</p> <ul><li>object-path: <code>roles</code></li></ul> <h4 id="superuser"><a href="#superuser" class="header-anchor">#</a> Superuser</h4> <p>Any newly created permission will be associated with this role.</p> <ul><li>object-path: <code>roles.superuser</code></li> <li>type: <code>string</code></li> <li>default: <code>'superuser'</code></li></ul> <h3 id="permissions"><a href="#permissions" class="header-anchor">#</a> Permissions</h3> <p>List of special-purpose permissions.</p> <ul><li>object-path: <code>permissions</code></li></ul> <h4 id="global-support"><a href="#global-support" class="header-anchor">#</a> Global support</h4> <p>Name of the permission, which defines top-level system support.</p> <ul><li>object-path: <code>permissions.globalsupport</code></li> <li>type: <code>string</code></li> <li>default: <code>'globalsupport'</code></li></ul> <h4 id="survey-admin"><a href="#survey-admin" class="header-anchor">#</a> Survey admin</h4> <p>Name of the permission, which allows to work with any <code>survey</code> record.</p> <ul><li>object-path: <code>permissions.surveyadmin</code></li> <li>type: <code>string</code></li> <li>default: <code>'surveyadmin'</code></li></ul> <h4 id="foods-admin"><a href="#foods-admin" class="header-anchor">#</a> Foods admin</h4> <p>Name of the permission, which allows to work with any <code>food</code> record.</p> <ul><li>object-path: <code>permissions.foodsadmin</code></li> <li>type: <code>string</code></li> <li>default: <code>'foodsadmin'</code></li></ul> <h2 id="database"><a href="#database" class="header-anchor">#</a> Database</h2> <p>System consists of two databases:</p> <ul><li>Foods - stores food-related information, mostly static content</li> <li>System - stores users/surveys related information, system configuration etc</li></ul> <p>Connection info is defined per-environment (<code>development</code>, <code>test</code>, <code>production</code>) and per-database (<code>foods</code> and <code>system</code>).</p> <p>Path: <code>src/config/database.ts</code></p> <h3 id="host-2"><a href="#host-2" class="header-anchor">#</a> Host</h3> <ul><li>object-path: <code>[environment][database].host</code></li> <li>dotenv var: <code>DB_FOODS_HOST</code> and <code>DB_SYSTEM_HOST</code></li> <li>type: <code>string</code></li> <li>default: <code>'localhost'</code></li></ul> <h3 id="port-2"><a href="#port-2" class="header-anchor">#</a> Port</h3> <ul><li>object-path: <code>[environment][database].port</code></li> <li>dotenv var: <code>DB_FOODS_PORT</code> and <code>DB_SYSTEM_PORT</code></li> <li>type: <code>number</code></li> <li>default: <code>5432</code></li></ul> <h3 id="database-2"><a href="#database-2" class="header-anchor">#</a> Database</h3> <ul><li>object-path: <code>[environment][database].database</code></li> <li>dotenv var: <code>DB_FOODS_DATABASE</code> and <code>DB_SYSTEM_DATABASE</code></li> <li>type: <code>string</code></li> <li>default: <code>'intake24_foods'</code> and <code>'intake24_system'</code></li></ul> <h3 id="username"><a href="#username" class="header-anchor">#</a> Username</h3> <ul><li>object-path: <code>[environment][database].username</code></li> <li>dotenv var: <code>DB_FOODS_USERNAME</code> and <code>DB_SYSTEM_USERNAME</code></li> <li>type: <code>string</code></li> <li>default: <code>'intake24'</code></li></ul> <h3 id="password"><a href="#password" class="header-anchor">#</a> Password</h3> <ul><li>object-path: <code>[environment][database].password</code></li> <li>dotenv var: <code>DB_FOODS_PASSWORD</code> and <code>DB_SYSTEM_PASSWORD</code></li> <li>type: <code>string</code></li> <li>default: <code>''</code></li></ul> <h3 id="dialect"><a href="#dialect" class="header-anchor">#</a> Dialect</h3> <ul><li>object-path: <code>[environment][database].dialect</code></li> <li>dotenv var: <code>DB_FOODS_DRIVER</code> and <code>DB_SYSTEM_DRIVER</code></li> <li>type: <code>'mysql' | 'postgres' | 'sqlite' | 'mariadb' | 'mssql'</code></li> <li>default: <code>'postgres'</code></li></ul> <h2 id="filesystem"><a href="#filesystem" class="header-anchor">#</a> Filesystem</h2> <p>Path: <code>src/config/filesystem.ts</code></p> <h3 id="logs-dir"><a href="#logs-dir" class="header-anchor">#</a> Logs dir</h3> <p>Logs directory where all application logs are stored.</p> <ul><li>object-path: <code>local.logs</code></li> <li>dotenv var: <code>FS_LOGS</code></li> <li>type: <code>string</code></li> <li>default: <code>'storage/logs'</code></li></ul> <h3 id="public-dir"><a href="#public-dir" class="header-anchor">#</a> Public dir</h3> <p>Public directory for serving static files.</p> <ul><li>object-path: <code>local.public</code></li> <li>dotenv var: <code>FS_PUBLIC</code></li> <li>type: <code>string</code></li> <li>default: <code>'public'</code></li></ul> <h2 id="mail"><a href="#mail" class="header-anchor">#</a> Mail</h2> <p>Mail implementation supports following transports:</p> <ul><li><code>SMTP</code> - SMTP protocol</li> <li><code>Log</code> - logs messages to <code>stdout</code> (for debugging purposes)</li></ul> <p>Implementation is using <a href="https://nodemailer.com" target="_blank" rel="noopener noreferrer">nodemailer<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>Path: <code>src/config/mail.ts</code></p> <h3 id="mailer"><a href="#mailer" class="header-anchor">#</a> Mailer</h3> <p>Selected mailer transport</p> <ul><li>object-path: <code>mailer</code></li> <li>dotenv var: <code>MAIL_MAILER</code></li> <li>type: <code>'smtp' | 'log'</code></li> <li>default: <code>'log'</code></li></ul> <h3 id="smtp-transport"><a href="#smtp-transport" class="header-anchor">#</a> SMTP transport</h3> <h4 id="host-3"><a href="#host-3" class="header-anchor">#</a> Host</h4> <ul><li>object-path: <code>mailers.smtp.host</code></li> <li>dotenv var: <code>MAIL_HOST</code></li> <li>type: <code>string</code></li> <li>default: <code>'localhost'</code></li></ul> <h4 id="port-3"><a href="#port-3" class="header-anchor">#</a> Port</h4> <ul><li>object-path: <code>mailers.smtp.port</code></li> <li>dotenv var: <code>MAIL_PORT</code></li> <li>type: <code>number</code></li> <li>default: <code>25</code></li></ul> <h4 id="secure"><a href="#secure" class="header-anchor">#</a> Secure</h4> <ul><li>object-path: <code>mailers.smtp.secure</code></li> <li>dotenv var: <code>MAIL_SECURE</code></li> <li>type: <code>boolean</code></li> <li>default: <code>false</code></li></ul> <h4 id="ignoretls"><a href="#ignoretls" class="header-anchor">#</a> ignoreTLS</h4> <ul><li>object-path: <code>mailers.smtp.ignoreTLS</code></li> <li>dotenv var: <code>MAIL_IGNORE_TLS</code></li> <li>type: <code>boolean</code></li> <li>default: <code>false</code></li></ul> <h4 id="authentication"><a href="#authentication" class="header-anchor">#</a> Authentication</h4> <ul><li><p>object-path: <code>mailers.smtp.auth.username</code></p></li> <li><p>dotenv var: <code>MAIL_USERNAME</code></p></li> <li><p>type: <code>string | null</code></p></li> <li><p>default: <code>null</code></p></li> <li><p>object-path: <code>mailers.smtp.auth.pass</code></p></li> <li><p>dotenv var: <code>MAIL_PASSWORD</code></p></li> <li><p>type: <code>string | null</code></p></li> <li><p>default: <code>null</code></p></li></ul> <h3 id="from"><a href="#from" class="header-anchor">#</a> From</h3> <ul><li>object-path: <code>from</code></li></ul> <h4 id="address"><a href="#address" class="header-anchor">#</a> Address</h4> <ul><li>object-path: <code>from.address</code></li> <li>dotenv var: <code>MAIL_FROM_ADDRESS</code></li> <li>type: <code>string</code></li> <li>default: <code>'example@domain.com'</code></li></ul> <h4 id="name-2"><a href="#name-2" class="header-anchor">#</a> Name</h4> <ul><li>object-path: <code>from.name</code></li> <li>dotenv var: <code>MAIL_FROM_NAME</code></li> <li>type: <code>string</code></li> <li>default: <code>'Intake24'</code></li></ul> <h2 id="queue"><a href="#queue" class="header-anchor">#</a> Queue</h2> <p>Queueing system is handled by <a href="https://redis.io" target="_blank" rel="noopener noreferrer">Redis<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> &amp; <a href="https://github.com/taskforcesh/bullmq" target="_blank" rel="noopener noreferrer">bullmq<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="redis-instance-connection"><a href="#redis-instance-connection" class="header-anchor">#</a> Redis instance connection</h3> <h4 id="host-4"><a href="#host-4" class="header-anchor">#</a> Host</h4> <ul><li>object-path: <code>redis.host</code></li> <li>dotenv var: <code>QUEUE_REDIS_HOST</code></li> <li>type: <code>string</code></li> <li>default: <code>'localhost'</code></li></ul> <h4 id="port-4"><a href="#port-4" class="header-anchor">#</a> Port</h4> <ul><li>object-path: <code>redis.port</code></li> <li>dotenv var: <code>QUEUE_REDIS_PORT</code></li> <li>type: <code>number</code></li> <li>default: <code>6379</code></li></ul> <h2 id="security"><a href="#security" class="header-anchor">#</a> Security</h2> <p>Path: <code>src/config/security.ts</code></p> <h3 id="cross-origin-resource-sharing-cors"><a href="#cross-origin-resource-sharing-cors" class="header-anchor">#</a> Cross-origin resource sharing (CORS)</h3> <h4 id="cors-origin"><a href="#cors-origin" class="header-anchor">#</a> CORS Origin</h4> <p>Single origin or list of origins to allow cross-origin resource sharing. Define these, when SPA applications (<code>admin</code> and <code>survey</code> sites) are deployed to different domain than <code>API Server</code></p> <ul><li>object-path: <code>cors.origin</code></li> <li>dotenv var: <code>CORS_ORIGIN</code> (for list of origins, use <code>comma-delimited</code> string)</li> <li>type: <code>string | string[] | boolean</code></li> <li>default: <code>false</code></li></ul> <h3 id="json-web-tokens"><a href="#json-web-tokens" class="header-anchor">#</a> JSON web tokens</h3> <p>JSON web tokens (<code>JWT</code>) settings</p> <h4 id="issuer"><a href="#issuer" class="header-anchor">#</a> Issuer</h4> <p>Issuer for signing JWT tokens</p> <ul><li>object-path: <code>jwt.issuer</code></li> <li>type: <code>string</code></li> <li>default: <code>'intake24'</code></li></ul> <h4 id="access-token-secret"><a href="#access-token-secret" class="header-anchor">#</a> Access token secret</h4> <p>Secret to sign JWT access token</p> <ul><li>object-path: <code>jwt.access.secret</code></li> <li>dotenv var: <code>JWT_ACCESS_SECRET</code></li> <li>type: <code>string</code></li></ul> <h4 id="access-token-lifetime"><a href="#access-token-lifetime" class="header-anchor">#</a> Access token lifetime</h4> <p>Lifetime of JWT access token. Define as ms-formatted string, see <a href="https://github.com/vercel/ms" target="_blank" rel="noopener noreferrer">ms<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for more information.</p> <ul><li>object-path: <code>jwt.access.lifetime</code></li> <li>dotenv var: <code>JWT_ACCESS_LIFETIME</code></li> <li>type: <code>string</code></li> <li>default: <code>'15m'</code></li></ul> <h4 id="refresh-token-secret"><a href="#refresh-token-secret" class="header-anchor">#</a> Refresh token secret</h4> <p>Secret to sign JWT refresh token</p> <ul><li>object-path: <code>jwt.refresh.secret</code></li> <li>dotenv var: <code>JWT_REFRESH_SECRET</code></li> <li>type: <code>string</code></li></ul> <h4 id="refresh-token-lifetime"><a href="#refresh-token-lifetime" class="header-anchor">#</a> Refresh token lifetime</h4> <p>Lifetime of JWT refresh token. Define as ms-formatted string, see <a href="https://github.com/vercel/ms" target="_blank" rel="noopener noreferrer">ms<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for more information.</p> <ul><li>object-path: <code>jwt.refresh.lifetime</code></li> <li>dotenv var: <code>JWT_REFRESH_LIFETIME</code></li> <li>type: <code>string</code></li> <li>default: <code>'1d'</code></li></ul> <h3 id="jwt-refresh-token-cookie"><a href="#jwt-refresh-token-cookie" class="header-anchor">#</a> JWT Refresh token cookie</h3> <p>Refresh token is stored in <code>http-only</code> cookie in client's browser. There are several properties to configure refresh token cookie.</p> <h4 id="cookie-name"><a href="#cookie-name" class="header-anchor">#</a> Cookie name</h4> <ul><li>object-path: <code>jwt.cookie.name</code></li> <li>type: <code>string</code></li> <li>default: <code>it24_refresh_token</code></li></ul> <h4 id="cookie-maxage"><a href="#cookie-maxage" class="header-anchor">#</a> Cookie maxAge</h4> <ul><li>object-path: <code>jwt.cookie.name</code></li> <li>default: <code>jwt.refresh.lifetime</code> value</li> <li>type: <code>string</code></li></ul> <h4 id="cookie-httponly"><a href="#cookie-httponly" class="header-anchor">#</a> Cookie httpOnly</h4> <ul><li>object-path: <code>jwt.cookie.httpOnly</code></li> <li>type: <code>boolean</code></li> <li>default: <code>true</code></li></ul> <h4 id="cookie-path"><a href="#cookie-path" class="header-anchor">#</a> Cookie path</h4> <ul><li>object-path: <code>jwt.cookie.path</code></li> <li>dotenv var: <code>JWT_COOKIE_PATH</code></li> <li>type: <code>string</code></li> <li>default: <code>'/api/refresh'</code></li></ul> <h4 id="cookie-samesite"><a href="#cookie-samesite" class="header-anchor">#</a> Cookie sameSite</h4> <ul><li>object-path: <code>jwt.cookie.sameSite</code></li> <li>dotenv var: <code>JWT_COOKIE_SAMESITE</code></li> <li>type: <code>boolean | 'lax' | 'strict' | 'none'</code></li> <li>default: <code>'lax'</code></li></ul> <h4 id="cookie-secure"><a href="#cookie-secure" class="header-anchor">#</a> Cookie secure</h4> <ul><li>object-path: <code>jwt.cookie.httpOnly</code></li> <li>dotenv var: <code>JWT_COOKIE_SECURE</code></li> <li>type: <code>boolean</code></li> <li>default: <code>false</code></li></ul> <h2 id="multi-factor-authentication-mfa"><a href="#multi-factor-authentication-mfa" class="header-anchor">#</a> Multi-factor authentication (MFA)</h2> <p>System supports multi-factor authentication (<code>MFA</code>) for admin login.</p> <p>Supported providers:</p> <ul><li><a href="https://duo.com" target="_blank" rel="noopener noreferrer">Duo Security<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>MFA has to be enabled on system-level (configuration) and user-level (database user record).</p> <h3 id="enabled"><a href="#enabled" class="header-anchor">#</a> Enabled</h3> <p>Determines whether the MFA is system-enabled or not</p> <ul><li>object-path: <code>mfa.enabled</code></li> <li>dotenv var: <code>MFA_ENABLED</code></li> <li>type: <code>boolean</code></li> <li>default: <code>false</code></li></ul> <h3 id="provider"><a href="#provider" class="header-anchor">#</a> Provider</h3> <p>Selected provider for MFA</p> <ul><li>object-path: <code>mfa.provider</code></li> <li>dotenv var: <code>MFA_PROVIDER</code></li> <li>type: <code>'duo'</code></li> <li>default: <code>'duo'</code></li></ul> <h3 id="duo-provider-settings"><a href="#duo-provider-settings" class="header-anchor">#</a> Duo provider settings</h3> <p>For more information, check out <a href="https://duo.com/docs/duoweb" target="_blank" rel="noopener noreferrer">duo's documentation for WebSDK<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h4 id="integration-key"><a href="#integration-key" class="header-anchor">#</a> Integration key</h4> <ul><li>object-path: <code>mfa.providers.duo.ikey</code></li> <li>dotenv var: <code>DUO_IKEY</code></li> <li>type: <code>string</code></li> <li>default: <code>''</code></li></ul> <h4 id="secret-key"><a href="#secret-key" class="header-anchor">#</a> Secret key</h4> <ul><li>object-path: <code>mfa.providers.duo.skey</code></li> <li>dotenv var: <code>DUO_SKEY</code></li> <li>type: <code>string</code></li> <li>default: <code>''</code></li></ul> <h4 id="application-secret-key"><a href="#application-secret-key" class="header-anchor">#</a> Application secret key</h4> <ul><li>object-path: <code>mfa.providers.duo.akey</code></li> <li>dotenv var: <code>DUO_AKEY</code></li> <li>type: <code>string</code></li> <li>default: <code>''</code></li></ul> <h4 id="host-5"><a href="#host-5" class="header-anchor">#</a> Host</h4> <p>API hostname (e.g. api-a1b2c3d4e5.duosecurity.com)</p> <ul><li>object-path: <code>mfa.providers.duo.host</code></li> <li>dotenv var: <code>DUO_HOST</code></li> <li>type: <code>string</code></li> <li>default: <code>''</code></li></ul> <h2 id="google-recaptcha"><a href="#google-recaptcha" class="header-anchor">#</a> Google reCAPTCHA</h2> <p>Password recovery can be protected by <a href="https://developers.google.com/recaptcha/intro" target="_blank" rel="noopener noreferrer">Google reCAPTCHA<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. V2 is currently supported.</p> <h3 id="enabled-2"><a href="#enabled-2" class="header-anchor">#</a> Enabled</h3> <p>Determines whether the reCAPTCHA is enabled or not.</p> <ul><li>object-path: <code>recaptcha.enabled</code></li> <li>dotenv var: <code>RECAPTCHA_ENABLED</code></li> <li>type: <code>boolean</code></li> <li>default: <code>false</code></li></ul> <h3 id="secret-key-2"><a href="#secret-key-2" class="header-anchor">#</a> Secret key</h3> <ul><li>object-path: <code>recaptcha.secret</code></li> <li>dotenv var: <code>RECAPTCHA_SECRET</code></li> <li>type: <code>string</code></li> <li>default: <code>''</code></li></ul> <h2 id="passwords"><a href="#passwords" class="header-anchor">#</a> Passwords</h2> <p>Settings for password restore functionality.</p> <h3 id="expire"><a href="#expire" class="header-anchor">#</a> Expire</h3> <p>Password reset link expiration in <strong>minutes</strong>.</p> <ul><li>object-path: <code>passwords.expire</code></li> <li>type: <code>number</code></li> <li>default: <code>60</code></li></ul> <h3 id="throttle"><a href="#throttle" class="header-anchor">#</a> Throttle</h3> <p>Rate limit setting for password request. It allows 1 request per <code>throttle</code> value. Value is set in <strong>seconds</strong>.</p> <ul><li>object-path: <code>passwords.throttle</code></li> <li>type: <code>number</code></li> <li>default: <code>60</code></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/config/" class="prev router-link-active">
        Introduction
      </a></span> <span class="next"><a href="/config/admin.html">
        Admin site
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.f0ab9d08.js" defer></script><script src="/assets/js/2.23416343.js" defer></script><script src="/assets/js/25.70f658ff.js" defer></script>
  </body>
</html>
